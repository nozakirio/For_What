<p><%= @book.title %></p>
<p><%= @book.author %></p>
<p><%= image_tag(@book.book_image_id) %></p>
<p><%= @book.publication_date %></p>

<h1>レビュー一覧</h1>
<div class="table">
  <div class="table_line">
    <div class="box"></div>
    <div class="box">ユーザー名</div>
    <div class="box">評価</div>
    <div class="box">理由</div>
    <div class="box">リンク</div>
  </div>
  <div data-turbolinks="false">
    <% @posts.each_with_index do |post,index| %>
      <% if post.star != nil %>
        <div class="table_line">
        <div class="box"><%= attachment_image_tag post.user, :profile_image, :fill, 50, 50, fallback: "no_image.jpg",size:'50x50' %></div></div>
        <div class="box"><%= link_to post.user.name, user_path(post.user) %></div>
        <div class="box" id="star-<%= index %>" data-score="<%= post.star %>"></div>
        <div class="box"><%= post.reason %></div>
        <div class="box"><%= link_to "投稿詳細", post_path(post) %></div>
      <% end %>
    <% end %>
  </div>

<script>
  $(function () {
    for (var i=0; i<"<%= @posts.size %>"; i++) {
    $(`#star-${i}`).raty({
      size: 36,
      starOff: "/assets/star-off.png",
      starOn: "/assets/star-on.png",
      scoreName: "score"
    });
    };
  });
</script>